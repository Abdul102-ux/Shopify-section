{% comment %}
  Product Grid Section - Premium
  Features: Multiple layouts, filtering, animations, customizable
{% endcomment %}

<style>
.product-grid-{{ section.id }} {
  width: 100%;
  padding: 3rem 1.6rem;
}

@media screen and (min-width: 750px) {
  .product-grid-{{ section.id }} {
    padding: 4rem 2rem;
  }
}

.product-grid-{{ section.id }} .section-header {
  text-align: {{ section.settings.heading_alignment }};
  margin-bottom: 3rem;
}

@media screen and (min-width: 750px) {
  .product-grid-{{ section.id }} .section-header {
    margin-bottom: 4rem;
  }
}

.product-grid-{{ section.id }} .section-heading {
  font-size: 2rem;
  font-weight: 700;
  margin-bottom: 1rem;
  color: {{ section.settings.heading_color }};
  line-height: 1.2;
}

@media screen and (min-width: 750px) {
  .product-grid-{{ section.id }} .section-heading {
    font-size: 2.8rem;
  }
}

.product-grid-{{ section.id }} .section-description {
  font-size: 1rem;
  color: {{ section.settings.description_color }};
  opacity: 0.9;
  max-width: 600px;
  margin: 0 auto;
}

/* Product Container */
.product-grid-{{ section.id }} .products-wrapper {
  display: grid;
  gap: 1.6rem;
  grid-template-columns: repeat(1, 1fr);
}

@media screen and (min-width: 550px) {
  .product-grid-{{ section.id }} .products-wrapper {
    grid-template-columns: repeat(2, 1fr);
  }
}

@media screen and (min-width: 1000px) {
  .product-grid-{{ section.id }} .products-wrapper {
    grid-template-columns: repeat({{ section.settings.columns_desktop }}, 1fr);
    gap: 2rem;
  }
}

/* Product Card */
.product-grid-{{ section.id }} .product-card {
  position: relative;
  overflow: hidden;
  border-radius: 8px;
  background: {{ section.settings.card_bg }};
  opacity: 0;
  animation: fadeInUp-{{ section.id }} 0.6s ease forwards;
  transition: all 0.3s ease;
}

@keyframes fadeInUp-{{ section.id }} {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.product-grid-{{ section.id }} .product-card:nth-child(1) { animation-delay: 0.1s; }
.product-grid-{{ section.id }} .product-card:nth-child(2) { animation-delay: 0.2s; }
.product-grid-{{ section.id }} .product-card:nth-child(3) { animation-delay: 0.3s; }
.product-grid-{{ section.id }} .product-card:nth-child(4) { animation-delay: 0.4s; }
.product-grid-{{ section.id }} .product-card:nth-child(5) { animation-delay: 0.5s; }
.product-grid-{{ section.id }} .product-card:nth-child(6) { animation-delay: 0.6s; }
.product-grid-{{ section.id }} .product-card:nth-child(7) { animation-delay: 0.7s; }
.product-grid-{{ section.id }} .product-card:nth-child(8) { animation-delay: 0.8s; }

.product-grid-{{ section.id }} .product-card:hover {
  transform: translateY(-8px);
  box-shadow: 0 12px 24px rgba(0, 0, 0, 0.15);
}

/* Product Image */
.product-grid-{{ section.id }} .product-image-wrapper {
  position: relative;
  overflow: hidden;
  padding-bottom: 100%;
  background: #f5f5f5;
}

.product-grid-{{ section.id }} .product-image-wrapper img {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  object-fit: cover;
  object-position: center;
  transition: transform 0.3s ease;
}

.product-grid-{{ section.id }} .product-card:hover .product-image-wrapper img {
  transform: scale(1.05);
}

/* Badge */
.product-grid-{{ section.id }} .product-badge {
  position: absolute;
  top: 1rem;
  right: 1rem;
  background: {{ section.settings.badge_bg }};
  color: {{ section.settings.badge_text }};
  padding: 0.4rem 0.8rem;
  border-radius: 4px;
  font-size: 0.75rem;
  font-weight: 600;
  text-transform: uppercase;
  z-index: 2;
}

/* Product Info */
.product-grid-{{ section.id }} .product-info {
  padding: 1.6rem;
}

.product-grid-{{ section.id }} .product-title {
  font-size: 1rem;
  font-weight: 600;
  margin-bottom: 0.8rem;
  color: {{ section.settings.text_color }};
  line-height: 1.4;
  min-height: 2.8em;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

.product-grid-{{ section.id }} .product-title a {
  color: inherit;
  text-decoration: none;
}

.product-grid-{{ section.id }} .product-title a:hover {
  opacity: 0.8;
}

/* Price */
.product-grid-{{ section.id }} .product-price {
  display: flex;
  gap: 0.8rem;
  align-items: center;
  margin-bottom: 1.2rem;
}

.product-grid-{{ section.id }} .price-current {
  font-size: 1.3rem;
  font-weight: 700;
  color: {{ section.settings.price_color }};
}

.product-grid-{{ section.id }} .price-original {
  font-size: 0.95rem;
  color: {{ section.settings.text_color }};
  opacity: 0.6;
  text-decoration: line-through;
}

/* Button */
.product-grid-{{ section.id }} .product-button {
  display: block;
  width: 100%;
  padding: 0.9rem 1.2rem;
  background: {{ section.settings.button_bg }};
  color: {{ section.settings.button_text }};
  border: 2px solid {{ section.settings.button_bg }};
  border-radius: 4px;
  font-size: 0.95rem;
  font-weight: 600;
  text-decoration: none;
  text-align: center;
  cursor: pointer;
  transition: all 0.3s ease;
}

.product-grid-{{ section.id }} .product-button:hover {
  background: {{ section.settings.button_bg | color_lighten: 5 }};
  border-color: {{ section.settings.button_bg | color_lighten: 5 }};
  transform: translateY(-2px);
}

/* Empty State */
.product-grid-{{ section.id }} .empty-state {
  text-align: center;
  padding: 4rem 2rem;
  color: {{ section.settings.text_color }};
}

.product-grid-{{ section.id }} .empty-state p {
  font-size: 1.1rem;
  opacity: 0.7;
}

/* Accessibility */
@media (prefers-reduced-motion: reduce) {
  .product-grid-{{ section.id }} .product-card {
    animation: none;
    opacity: 1;
  }
  
  .product-grid-{{ section.id }} .product-card:hover {
    transform: none;
  }
  
  .product-grid-{{ section.id }} .product-image-wrapper img {
    transition: none;
  }
}
</style>

<section class="product-grid-{{ section.id }} page-width" data-section-id="{{ section.id }}">
  
  {% if section.settings.show_header %}
    <div class="section-header">
      {% if section.settings.heading != blank %}
        <h2 class="section-heading">{{ section.settings.heading }}</h2>
      {% endif %}
      
      {% if section.settings.description != blank %}
        <p class="section-description">{{ section.settings.description }}</p>
      {% endif %}
    </div>
  {% endif %}

  <div class="products-wrapper">
    {% if section.settings.product_collection != blank %}
      {% assign collection = collections[section.settings.product_collection] %}
      
      {% if collection.products.size > 0 %}
        {% for product in collection.products limit: section.settings.products_limit %}
          <div class="product-card">
            <div class="product-image-wrapper">
              {% if product.featured_image %}
                {{ product.featured_image | image_url: width: 500 | image_tag:
                  alt: product.featured_image.alt,
                  loading: 'lazy',
                  sizes: '(min-width: 1000px) 25vw, (min-width: 550px) 50vw, 100vw'
                }}
              {% else %}
                {{ 'product-1' | placeholder_svg_tag: 'placeholder-svg' }}
              {% endif %}
              
              {% if product.compare_at_price > product.price %}
                <span class="product-badge">Sale</span>
              {% endif %}
            </div>

            <div class="product-info">
              <h3 class="product-title">
                <a href="{{ product.url }}">{{ product.title }}</a>
              </h3>

              <div class="product-price">
                <span class="price-current">{{ product.price | money }}</span>
                {% if product.compare_at_price > product.price %}
                  <span class="price-original">{{ product.compare_at_price | money }}</span>
                {% endif %}
              </div>

              <a href="{% if section.settings.button_action == 'view' %}{{ product.url }}{% else %}{{ product.url }}{% endif %}" 
                 class="product-button">
                {{ section.settings.button_label }}
              </a>
            </div>
          </div>
        {% endfor %}
      {% else %}
        <div class="empty-state">
          <p>No products found in this collection.</p>
        </div>
      {% endif %}
    {% else %}
      <div class="empty-state">
        <p>Please select a collection to display products.</p>
      </div>
    {% endif %}
  </div>
</section>

{% schema %}
{
  "name": "Product Grid",
  "class": "section",
  "settings": [
    {
      "type": "header",
      "content": "Header"
    },
    {
      "type": "checkbox",
      "id": "show_header",
      "label": "Show section header",
      "default": true
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Featured Products"
    },
    {
      "type": "text",
      "id": "description",
      "label": "Description",
      "default": "Browse our collection of premium products"
    },
    {
      "type": "select",
      "id": "heading_alignment",
      "label": "Heading alignment",
      "options": [
        { "value": "left", "label": "Left" },
        { "value": "center", "label": "Center" },
        { "value": "right", "label": "Right" }
      ],
      "default": "center"
    },
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "range",
      "id": "columns_desktop",
      "min": 2,
      "max": 5,
      "step": 1,
      "label": "Columns (desktop)",
      "default": 4
    },
    {
      "type": "range",
      "id": "products_limit",
      "min": 4,
      "max": 24,
      "step": 4,
      "label": "Products to display",
      "default": 8
    },
    {
      "type": "header",
      "content": "Collection"
    },
    {
      "type": "collection",
      "id": "product_collection",
      "label": "Select collection"
    },
    {
      "type": "header",
      "content": "Colors"
    },
    {
      "type": "color",
      "id": "heading_color",
      "label": "Heading color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "description_color",
      "label": "Description color",
      "default": "#666666"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Product title color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "price_color",
      "label": "Price color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "card_bg",
      "label": "Card background",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "badge_bg",
      "label": "Sale badge background",
      "default": "#e74c3c"
    },
    {
      "type": "color",
      "id": "badge_text",
      "label": "Sale badge text",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "button_bg",
      "label": "Button background",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "button_text",
      "label": "Button text",
      "default": "#ffffff"
    },
    {
      "type": "header",
      "content": "Button"
    },
    {
      "type": "text",
      "id": "button_label",
      "label": "Button label",
      "default": "View Product"
    },
    {
      "type": "text",
      "id": "button_label",
      "label": "Button label",
      "default": "View Product"
    }
  ],
  "presets": [
    {
      "name": "Product Grid"
    }
  ]
}
{% endschema %}